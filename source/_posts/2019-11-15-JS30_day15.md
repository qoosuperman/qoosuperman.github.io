---
title: "JS30 day15 Local Storage and Event delegation"
catalog: true
toc_nav_num: true
date: 2019-11-15 22:26:24
subtitle: ""
header-img: "https://images.unsplash.com/photo-1573761608477-786bcf22db23?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1950&q=80"
tags:
- Javascript
catagories:
- Javascript
updateDate: 2019-11-15 22:26:24
# top: 1

---

# JS30 day15 - JS30 day15 Local Storage and Event delegation

## ä½œæ¥­å…§å®¹

ä»Šå¤©çš„å…§å®¹åœ¨è¬›èªªå¦‚ä½•ä½¿ç”¨ Local Storage é‚„æœ‰å¦‚æœè¦æŒ‡å®šç›£è½çš„å°è±¡æ˜¯å‹•æ…‹è®ŠåŒ–çš„æ‡‰è©²æ€éº¼è™•ç†ï¼Œç¶²é çš„éƒ¨åˆ†æ˜¯é€éä¸€å€‹èœå–®ä¾†å¯¦ä½œ

## å­¸åˆ°ä»€éº¼

- JS
  1. `preventDefault()`
  åƒè€ƒè³‡æ–™ï¼šhttps://ithelp.ithome.com.tw/articles/10198999
  2. ä½¿ç”¨å±¬æ€§ä¾†ç•¶ä½œé¸æ“‡å™¨ `this.querySelector('[name=item]')`
  ```html
  <input type="text" name="item" placeholder="Item Name" required="">
  ```
  3. ä½¿ç”¨ `this.reset();` é‡ç½®è¡¨å–®
  4. åœ¨æ¨™ç±¤è£¡é¢å‹•æ…‹æ’å…¥ `<li>`æ¨™ç±¤ï¼š
  ```js
  function populateList(plates = [], plateList){
    plateList.innerHTML = plates.map((plate, i) => {
      return `
        <li>
          <label for="">${plate.text}</label>
        </li>
      `
    }).join("");
  }
  ```
  5. åœ¨ html è£¡é¢ï¼Œå¦‚æœæœ‰ä¸€å€‹ checkbox çš„ input
  ä»¥ä¸‹ä¸‰ç¨®ç‹€æ³éƒ½é‚„æ˜¯æœƒè®“ä»–å‘ˆç¾ checked:true çš„ç‹€æ…‹
  ```html
  <input type="checkbox" checked>
  <input type="checkbox" checked="qq">
  <input type="checkbox" checked=false>
  ```
  æ‰€ä»¥å¦‚æœè¦æ ¹æ“šå±¬æ€§ä¸åŒåšå‡ºä¸åŒçš„ checked ç‹€æ…‹ï¼Œåªèƒ½åŠ å…¥ checked æˆ–æ˜¯ç©ºç™½å­—å…ƒ
  ```js
  //å¯«åœ¨ js è£¡é¢
  <input type="checkbox" data-index=${i} id="item${i}" ${plate.done ? 'checked' : ''}>
  ```
  6. `localStorage` æ˜¯å€‹å¯ä»¥æŠŠè³‡æ–™å„²å­˜åœ¨ç€è¦½å™¨çš„ç©ºé–“ï¼Œä¸éè¦è¨˜å¾—åªèƒ½å­˜å­—ä¸²
  ```js
  localStorage.setItem("items", items) //ç¬¬ä¸€å€‹åƒæ•¸æ˜¯ key çš„åå­—ï¼Œç¬¬äºŒå€‹åƒæ•¸æ˜¯è¦å­˜çš„æ±è¥¿
  localStorage.getItem()
  localStorage.removeItem()
  ```
  è€Œä¸€é–‹å§‹çš„ items å°±å¯ä»¥æ”¹ç‚ºå…ˆè©¦è‘—å¾ localStorage æŠ“è³‡æ–™ï¼Œæ²’æœ‰çš„è©±æ‰çµ¦ç©ºé™£åˆ—
  ```js
  const items = JSON.parse(localStorage.getItem('items')) || [];
  ```
  7. æˆ‘å€‘è¦å»æ•æ‰æ¯ä¸€å€‹æ–°é•·å‡ºä¾†çš„ list å»ç›£è½äº‹ä»¶ï¼Œå°é€™ç¨®å‹•æ…‹å…ƒç´ ï¼Œæœ€å¥½çš„æ–¹å¼æ˜¯å»**ç”¨ä»–çš„çˆ¶å…ƒç´ ç›£è½**ï¼Œåˆ©ç”¨å†’æ³¡æ©Ÿåˆ¶ï¼Œæ‰€ä»¥çˆ¶å…ƒç´ ä¹Ÿæœƒç›£è½åˆ°
  ```js
  function toggleDone(e){
    console.log(e.target)
  }
  itemsList.addEventListener('click', toggleDone)
  ```
  ä½†é€™æ¨£æœƒç”¢ç”Ÿå¦ä¸€å€‹å•é¡Œï¼Œå¾ console log å¯ä»¥çœ‹åˆ°æ¯æ¬¡éƒ½æœƒå‡ºç¾å…©å€‹äº‹ä»¶ï¼Œæ‰€ä»¥å¿…é ˆå†å»æ¿¾é™¤æ¢ä»¶
  ![](https://i.imgur.com/n3RrCBF.png)
  ```js
  function toggleDone(e){
  if(!e.target.matches('input')) return;
  }
  ```
åƒè€ƒè³‡æ–™ï¼š
https://github.com/wesbos/JavaScript30

code å…§å®¹ï¼š

HTML:
```html
<div class="wrapper">
  <h2>LOCAL TAPAS</h2>
  <p></p>
  <ul class="plates">
    <li>Loading Tapas...</li>
  </ul>
  <form class="add-items">
    <input type="text" name="item" placeholder="Item Name" required>
    <input type="submit" value="+ Add Item">
  </form>
</div>
```
CSS:
```css
html {
  box-sizing: border-box;
  background: url('http://wes.io/hx9M/oh-la-la.jpg') center no-repeat;
  background-size: cover;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  font-family: Futura,"Trebuchet MS",Arial,sans-serif;
}

*, *:before, *:after {
  box-sizing: inherit; 
}

svg {
  fill:white;
  background: rgba(0,0,0,0.1);
  padding: 20px;
  border-radius: 50%;
  width: 200px;
  margin-bottom: 50px;
}

.wrapper {
  padding: 20px;
  max-width: 350px;
  background: rgba(255,255,255,0.95);
  box-shadow: 0 0 0 10px rgba(0,0,0,0.1);
}

h2 {
  text-align: center;
  margin: 0;
  font-weight: 200;
}

.plates {
  margin: 0;
  padding: 0;
  text-align: left;
  list-style: none;
}

.plates li {
  border-bottom: 1px solid rgba(0,0,0,0.2);
  padding: 10px 0;
  font-weight: 100;
  display: flex;
}

.plates label {
  flex: 1;
  cursor: pointer;
}

.plates input {
  display: none;
}

.plates input + label:before {
  content: 'â¬œï¸';
  margin-right: 10px;
}

.plates input:checked + label:before {
  content: 'ğŸŒ®';
}

.add-items {
  margin-top: 20px;
}

.add-items input {
  padding: 10px;
  outline: 0;
  border: 1px solid rgba(0,0,0,0.1);
}
```
JS:
```js
const addItems = document.querySelector('.add-items');
const itemsList = document.querySelector('.plates');
const items = JSON.parse(localStorage.getItem('items')) || [];

function addItem(e){
  e.preventDefault();
  const text = (this.querySelector('[name=item]')).value;
  const item = {
    text: text,
    done: false
  }
  items.push(item);
  populateList(items, itemsList)
  localStorage.setItem("items", JSON.stringify(items))
  this.reset();
}

function populateList(plates = [], plateList){
  plateList.innerHTML = plates.map((plate, i) => {
    return `
      <li>
        <input type="checkbox" data-index=${i} id="item${i}" ${plate.done ? 'checked' : ''}>
        <label for="item${i}">${plate.text}</label>
      </li>
    `
  }).join("");
}

function toggleDone(e){
  if(!e.target.matches('input')) return;
  const el = e.target;
  const index = el.dataset.index;
  items[index].done = !items[index].done
  localStorage.setItem("items", JSON.stringify(items))
}

addItems.addEventListener('submit', addItem)
itemsList.addEventListener('click', toggleDone)
populateList(items, itemsList) // ä¸Šé¢é‚£ä¸€åˆ—æ˜¯è¡¨å–®é€å‡ºæ‰æœƒç™¼ç”Ÿä½œç”¨ï¼Œé€™ä¸€åˆ—æ˜¯é‡æ–°æ•´ç†æˆ–è€…é‡æ–°é€²åˆ°é€™å€‹ç¶²é éƒ½æœƒç™¼ç”Ÿä½œç”¨
```