<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Anthony&#39;s Blog, about Ruby / Rails / Devops">
    <meta name="keyword" content="">
    <meta property="og:image" content="undefined">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <title>
        
          Apps Script Intro - Anthony Chao | Blog
        
    </title>

    <link rel="canonical" href="https://qoosuperman.github.io/article/2021-11-28-Apps_Script_Intro/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/beantech.min.css">

    <link rel="stylesheet" href="/css/donate.css">

    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
<link rel="alternate" href="/atom.xml" title="Anthony Chao" type="application/atom+xml">
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('https://images.unsplash.com/photo-1593642634524-b40b5baae6bb?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDF8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=2664&amp;q=80')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#Javascript" title="Javascript">Javascript</a>
                            
                              <a class="tag" href="/tags/#Apps Script" title="Apps Script">Apps Script</a>
                            
                        </div>
                        <h1>Apps Script Intro</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by Anthony Chao on
                            2021-11-28
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Anthony Chao</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archive</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h2>Intro</h2>
<p>最近想要加一些增進生活便利的功能，但又不想去 AWS 上面開機器花錢錢，剛好工作的時候隔壁坐了一個 app script 精通玩家，藉此開始接觸這個工具，做些小筆記幫助在這裡</p>
<p>Note: App script 現在支援 ES6 語法，因此親民很多</p>
<h2>Outline</h2>
<ul>
<li><a href="#intro">Intro</a></li>
<li><a href="#how-to-begin">How to begin</a></li>
<li><a href="#how-to-execute">How to Execute</a></li>
<li><a href="#debug">Debug</a></li>
<li><a href="#special-rules">Special rules</a></li>
<li><a href="#libraries">Libraries</a></li>
<li><a href="#version-control">Version Control</a></li>
<li><a href="#google-api-cheatsheet">Google Api Cheatsheet</a></li>
<li><a href="#javascript-cheatsheet">Javascript Cheatsheet</a></li>
<li><a href="#others">Others</a></li>
<li><a href="#references">References</a></li>
</ul>
<h2>How to begin</h2>
<p>有兩種開啟方式：</p>
<ul>
<li>直接在 google drive 上面開新的 apps script 專案</li>
<li>透過 google sheet 開啟</li>
</ul>
<p>他們在專案管理畫面看起來就會不同<br>
<img src="https://i.imgur.com/12uQdtJ.png" alt=""></p>
<p>如果是用 sheet 開的 app script 就可以用下面的方式拿到 spread sheet 而不用指定 id</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SpreadsheetApp.getActiveSpreadsheet()</span><br></pre></td></tr></table></figure>
<h2>How to Execute</h2>
<p>要執行的時候，選單上面可以選擇 function 名字，選完之後按下旁邊的執行就可以執行 / 測試功能，如果要設定成定時啟動，去左邊有個小時鐘，那邊就可以設定啟動方式</p>
<p>當然這種免費服務是有 quota <a href="https://developers.google.com/apps-script/guides/services/quotas" target="_blank" rel="noopener">限制</a>的，不要太忘我設定了太多，到時候會有帳單寄過來</p>
<h2>Debug</h2>
<p>在每一行的最前面點一下會變成紫色，就等於下了中斷點</p>
<p><img src="https://i.imgur.com/kpUh3fE.png" alt=""></p>
<p>如果要 print 東西出來，用 <code>Logger.log()</code></p>
<h2>Special rules</h2>
<p>通常自己在寫 javascript 可以自己決定 function 名字，但在寫 app script 的時候要注意有些 function 名字是有特殊意義的，比方說你想要用這個 app script 做一個網頁就需要有一個 <code>doGet</code> 的 function 存在，你想要這個 google sheet 在打開的時候就做些什麼事情，你可以把 function 名字設定成 <code>onOpen</code>，這樣就不用另外設定 trigger，其他類似的還有很多，再麻煩自己看看 Google 文件</p>
<h2>Libraries</h2>
<p>如果想要用其他 app script 寫好的東西，可以在資料庫這邊加上 script id</p>
<p>有一些像是送 slack 訊息通常可以這樣用<br>
<img src="https://i.imgur.com/Cc4BHnc.png" alt=""></p>
<h2>Version Control</h2>
<p>使用 app script 要怎麼做版本控管呢？</p>
<p>感謝隔壁的大神開示，可以使用 <a href="https://developers.google.com/apps-script/guides/clasp" target="_blank" rel="noopener">clasp</a> 這個套件，隨時把 code pull 下來或者 push 上去，就可以搭配 git 做版本控管了！</p>
<p>但我本身開發還是比較常在 App script 的介面上面開發，因為 Google 自己的 api 在上面有很多自動補全的功能，效率會高一些</p>
<hr>
<p>如果是工程師背景的差不多可以開始寫了，接下來是自己補充的 cheatsheet</p>
<hr>
<h2>Google Api Cheatsheet</h2>
<h3>Property</h3>
<p>app script 裡面的 property 對我來說比較像一般 application 所謂的 credential</p>
<p>比方說在這個 script 裡面我會用到自己的記帳用 google sheet，但這些 code 我又會放上 Github 儲存，我是不太想要全世界都知道我的記帳用 google sheet 是放在哪裡，所以在 code 裡面想把它隱藏掉，這時候就會用到 property</p>
<p>App script 的 script 有三個層級：document / script / User</p>
<p>如果是 script properties，那把同一個 script 給別人執行，也會拿到一樣結果</p>
<p>但如果是 User 的層級，就是設定在個人身上，別人拿你的 code 執行也不知道你設定的 secret</p>
<p>使用方法如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> userProperty = PropertiesService.getUserProperties();</span><br><span class="line">userProperty.setProperty(<span class="string">'uservar'</span>, <span class="string">'Hello'</span>);</span><br><span class="line">Logger.log(userProperty.getProperty(<span class="string">'uservar'</span>)); <span class="comment">// Hello</span></span><br></pre></td></tr></table></figure>
<p>三種不同的 property:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PropertiesService.getUserProperties()</span><br><span class="line">PropertiesService.getScriptProperties()</span><br><span class="line">PropertiesService.getDocumentProperties()</span><br></pre></td></tr></table></figure>
<p>目前 UserProperty 在文件上面已經標註 deprecated，經過測試，不同 script 的 UserProperty 也沒辦法互相 share，更多請再參考<a href="https://developers.google.com/apps-script/reference/properties/properties" target="_blank" rel="noopener">文件</a></p>
<h3>Google Sheet</h3>
<h4>Special functions</h4>
<p>如果使用 google sheet 另外做出來的 app script，<code>onOpen</code> 這個 function 會在每次文件被打開的時候 trigger，就不用自己設定 trigger 了</p>
<h4>Customized menu</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onOpen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> spreadSheet = SpreadsheetApp.getActiveSpreadsheet()</span><br><span class="line">  <span class="keyword">let</span> menuItems = [</span><br><span class="line">    &#123;<span class="attr">name</span>: <span class="string">'insertEvents'</span>, <span class="attr">functionName</span>: <span class="string">'addEvents'</span>&#125;</span><br><span class="line">  ]</span><br><span class="line">  spreadSheet.addMenu(<span class="string">'在日曆上加入事件'</span>, menuItems)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/z7qA8Pc.png" alt=""></p>
<h4>Dropdown list</h4>
<p>這個操作有點反直覺，是用 <code>setDataValidation</code> 這個 method 來設定的</p>
<p>然後 trigger 需要設定在 on Edit，這樣每次有新的一列，才會讓新的這一列也有下單選單</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dropDownList</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> spreadSheet = SpreadsheetApp.openById(<span class="string">'gsheet_id'</span>)</span><br><span class="line">  <span class="keyword">let</span> mainSheet = spreadSheet.getSheetByName(<span class="string">'eventList'</span>)</span><br><span class="line">  <span class="comment">// set colors</span></span><br><span class="line">  <span class="keyword">let</span> colorList = spreadSheet.getSheetByName(<span class="string">'colors'</span>).getRange(<span class="string">'B2:B12'</span>).getValues()</span><br><span class="line">  <span class="keyword">let</span> colorRangeRule = SpreadsheetApp.newDataValidation().requireValueInList(colorList)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> lastRow = mainSheet.getLastRow()</span><br><span class="line">  mainSheet.getRange(<span class="number">2</span>, <span class="number">5</span>, lastRow<span class="number">-1</span>).setDataValidation(colorRangeRule)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4>Get the range of a table</h4>
<p>有時候會有點難拿到某個 table 的 region，比方說在同一個 sheet 裡面有資料跟另一個樞紐分析表，這時候可以用 <code>getDataRegion</code> 這個 function 去拿到樞紐分析表的範圍</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createPivotTable</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> sheet = spreadSheet.getSheetByName(<span class="string">'2021-10'</span>)</span><br><span class="line">  <span class="keyword">let</span> lastRow = sheet.getLastRow()</span><br><span class="line">  <span class="keyword">let</span> sourceData = sheet.getRange(<span class="number">1</span>,<span class="number">1</span>,lastRow,<span class="number">7</span>);</span><br><span class="line">  <span class="keyword">var</span> pivotTable = sheet.getRange(<span class="string">'K1'</span>).createPivotTable(sourceData)</span><br><span class="line">  <span class="comment">// 用第六欄做分析</span></span><br><span class="line">  pivotTable.addPivotValue(<span class="number">6</span>, SpreadsheetApp.PivotTableSummarizeFunction.SUM);</span><br><span class="line">  <span class="comment">// 用第五欄做分類依據</span></span><br><span class="line">  <span class="keyword">var</span> pivotGroup = pivotTable.addRowGroup(<span class="number">5</span>)</span><br><span class="line">  <span class="keyword">let</span> range = sheet.getRange(<span class="string">'K1'</span>).getDataRegion()</span><br><span class="line">  Logger.log(range.getValues())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4>Chart</h4>
<p>把 Chart 變成圖片的方法：<a href="https://developers.google.com/apps-script/reference/charts/charts" target="_blank" rel="noopener">文件</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> imageData = Utilities.base64Encode(chart.getAs(<span class="string">'image/jpeg'</span>).getBytes())</span><br><span class="line"><span class="keyword">var</span> imageUrl = <span class="string">"data:image/jpeg;base64,"</span> + <span class="built_in">encodeURI</span>(imageData)</span><br></pre></td></tr></table></figure>
<p>我自己則用比較曲折的方法，先把圖片上傳到 drive 之後再用 multipart 的 form 送到 Line notify，可以參考我的 github <a href="https://github.com/qoosuperman/apps-scripts/blob/master/monthly_expense_summary/code.js#L126-L134" target="_blank" rel="noopener">repo</a></p>
<h4>Macro</h4>
<p>這算是一個小訣竅，有時候會覺得 Google 的 api 不知道怎麼使用，這時候可以用錄製巨集的方式加速開發，錄製完成之後打開原始碼，也會是 app script 的介面，這時候就可以看看自動生成的 code 怎麼做的</p>
<h3>Drive</h3>
<h3>get folder / file by name</h3>
<p>因為要用 name 拿到檔案或資料夾只有 getFoldersByName 或者 getFilesByName 這個 API</p>
<p>所以要用下面這個比較不直觀的寫法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> folder_iterator = DriveApp.getFoldersByName(foldername)</span><br><span class="line"><span class="keyword">var</span> folder</span><br><span class="line"><span class="keyword">if</span> (folder_iterator.hasNext()) &#123;</span><br><span class="line">  folder = folder_iterator.next();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  folder = DriveApp.createFolder(foldername);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3>Web</h3>
<p>也可以用 app script 部署網頁</p>
<p>但這個部署網頁的入口一律都是 <code>doGet</code> 這個 function</p>
<p>通常在網頁裡面會放一些 js 的 code，可以用 <code>HtmlService</code> 這 service + evaluete 把 js code 用樣版引擎的方式去跑，更多可以參考<a href="https://developers.google.com/apps-script/guides/html/templates#scriptlets" target="_blank" rel="noopener">文件</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doGet</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> HtmlService.createTemplateFromFile(<span class="string">'index'</span>)</span><br><span class="line">  .evaluate()</span><br><span class="line">  .setTitle(<span class="string">'下載檔案 from Anthony'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在樣板裡面可以直接呼叫別的 function</p>
<p>這裡的樣版引擎是用 <code>&lt;? ?&gt;</code></p>
<p>如果要顯示的話是用 <code>&lt;?= ?&gt;</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-12"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">'text-primary'</span>&gt;</span>檔案下載<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="php"><span class="meta">&lt;?</span> <span class="keyword">var</span> data = getData(); <span class="meta">?&gt;</span></span></span><br><span class="line">        <span class="php"><span class="meta">&lt;?</span> <span class="keyword">for</span>(let i = <span class="number">0</span>; i &lt; data.length; i++) &#123; <span class="meta">?&gt;</span></span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">              <span class="php"><span class="meta">&lt;?</span>= data[i][<span class="number">0</span>] <span class="meta">?&gt;</span></span></span><br><span class="line">              <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;?= data[i][4] ?&gt;"</span>&gt;</span> 下載 <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="php"><span class="meta">&lt;?</span> &#125; <span class="meta">?&gt;</span></span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>&lt;?!= ?&gt;</code>則是避免語境跳脫的顯示，通常用在要 include 另一段自己可以相信的 code</p>
<p>比方說自己寫的 html 裡面要 include 自己另一個檔案</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html --&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="php"><span class="meta">&lt;?</span>!= <span class="keyword">include</span>(<span class="string">'style.css'</span>); <span class="meta">?&gt;</span></span></span><br><span class="line">...</span><br><span class="line"><span class="comment">&lt;!-- style.css.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    body &#123;</span><br><span class="line">        font-family: "Microsoft JhengHei";</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>另外，我們除了 doGet 還可以在 app script 做一個 doPost function，他可以當作送 post 的 api，有了這兩個 api 就可以用 <code>doGet</code> 做出一個表單送回給自己的 <code>doPost</code> 端點來處理</p>
<p>這段是 html 的 code，我們把設定 form 的目的地，設定成 http method post，url 則是從 template 的 serviceUrl 屬性拿到</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- form.html --&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"&lt;?= serviceUrl ?&gt;"</span> <span class="attr">class</span>=<span class="string">"login-form mt-2"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"date"</span>&gt;</span>日期<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>下面這段是 app script 主體，在 template 身上放 serviceUrl 這個屬性，等這個 form 送出之後就會 trigger doPost 這個 function 的內容</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doGet</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> template = HtmlService.createTemplateFromFile(<span class="string">'index'</span>)</span><br><span class="line">  <span class="comment">// form 要送到哪個 url 塞到 template 的 serviceUrl 這個屬性</span></span><br><span class="line">  <span class="comment">// 會回傳這個 app 被部署到的 url</span></span><br><span class="line">  template.serviceUrl = ScriptApp.getService().getUrl()</span><br><span class="line">  <span class="keyword">return</span> template.evaluate().setTitle(<span class="string">'title'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doPost</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(e.parameter.date)</span><br><span class="line">  <span class="keyword">let</span> amount = e.parameter.amount</span><br><span class="line">  <span class="keyword">let</span> category = e.parameter.category</span><br><span class="line">  <span class="keyword">return</span> result(date, amount, category)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4>client side call server side script</h4>
<p>在網頁裡面還可以做到比較進階的事：直接 call server side script 做事情</p>
<p>所以雖然我們可能只有一個 post 端點，但透過這個就可以把網頁搞得很複雜</p>
<p>更多可以參考<a href="https://developers.google.com/apps-script/guides/html/reference/run" target="_blank" rel="noopener">文件</a></p>
<p>下面簡單寫一個範例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 沒有目的地的 form --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">'test'</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'submit'</span> <span class="attr">value</span>=<span class="string">"上傳檔案"</span> <span class="attr">onclick</span>=<span class="string">"this.value='檔案上傳中'; google.script.run.withSuccessHandler(fileUploaded).uploadFiles(this.parentNode);"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>這一段表示，觸動 onclick 之後執行幾件事情：</p>
<ol>
<li>這個按鈕顯示改成檔案上傳中</li>
<li>執行 server side 的 uploadFiles function，執行結果成功(因為有 catch error 所以不管怎樣都成功)就會把結果丟給 client side 的 fileUploaded function 執行</li>
</ol>
<p>js(client side):</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="comment">// 送出之後隱藏原本表單內容，顯示上傳結果</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">fileUploaded</span>(<span class="params">status</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'upload'</span>).style.display = <span class="string">'none'</span>;</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'output'</span>).innerHTML = status;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p>js(server side):</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uploadFilesAndRecord</span>(<span class="params">form</span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3>Calender</h3>
<p>開發的時候發現 calender api 有兩個：傳統的跟 advanced calender service</p>
<p>如果用傳統的 calender api, 要 insert calender event 的時候在 location 滿有限制的，我建議使用 advanced calender service</p>
<p>下面這個是傳統用法，注意這裡的時間要是 Date 物件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> endAt = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="built_in">Date</span>.parse(values[i][<span class="number">2</span>]))</span><br><span class="line"><span class="keyword">let</span> options = &#123;</span><br><span class="line">  location: values[i][<span class="number">2</span>], <span class="comment">// string</span></span><br><span class="line">  guests: values[i][<span class="number">3</span>],</span><br><span class="line">  sendInvites: <span class="literal">false</span>,</span><br><span class="line">  description: values[i][<span class="number">7</span>] || <span class="string">'No description'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> event = calender.createEvent(eventTitle, startAt, endAt, options)</span><br><span class="line">event.setColor(eventColor).addPopupReminder(remindBeforeMinutes)</span><br></pre></td></tr></table></figure>
<p>下面這個是用 advanced calender service</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> startAt = TimeUtilis.getAbsoluteDateHour(values[i][<span class="number">1</span>]).toISOString()</span><br><span class="line"><span class="keyword">let</span> endAt = TimeUtilis.getAbsoluteDateHour(values[i][<span class="number">2</span>]).toISOString()</span><br><span class="line"><span class="keyword">let</span> options = &#123;</span><br><span class="line">  summary: eventTitle,</span><br><span class="line">  location: location,</span><br><span class="line">  description: description,</span><br><span class="line">  start: &#123;</span><br><span class="line">    dateTime: startAt</span><br><span class="line">  &#125;,</span><br><span class="line">  end: &#123;</span><br><span class="line">    dateTime: endAt</span><br><span class="line">  &#125;,</span><br><span class="line">  attendees: [</span><br><span class="line">    &#123;<span class="attr">email</span>: <span class="string">'oldwuniwniw@gmail.com'</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">email</span>: <span class="string">'qoosuperman@gmail.com'</span>&#125;</span><br><span class="line">  ],</span><br><span class="line">  colorId: eventColor</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// To user Calender, the service must be turn on</span></span><br><span class="line"><span class="keyword">let</span> event = Calendar.Events.insert(options, <span class="string">'eqo1eottco4dtr18e5m0dd76d0@group.calendar.google.com'</span>);</span><br></pre></td></tr></table></figure>
<p>顏色對應的數字參考 <a href="https://developers.google.com/apps-script/reference/calendar/event-color" target="_blank" rel="noopener">這裡</a></p>
<hr>
<h2>Javascript Cheatsheet</h2>
<p>其實覺得比較麻煩的主要在分析日期上面，最坑的是 getMonth 拿回來的數字是 0-11，所以要加上 1 才是正確月份</p>
<p>範例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> date = <span class="built_in">parseInt</span>(<span class="keyword">new</span> <span class="built_in">Date</span>().getDate())</span><br><span class="line"><span class="keyword">var</span> hour = <span class="built_in">parseInt</span>(<span class="keyword">new</span> <span class="built_in">Date</span>().getHours())</span><br><span class="line"><span class="comment">// 如果要比較完整的年月日我會把它變成字串來比</span></span><br><span class="line"><span class="keyword">var</span> dateString = Utilities.formatDate(<span class="keyword">new</span> <span class="built_in">Date</span>(), <span class="string">'GMT+8'</span>, <span class="string">'yyyy-MM-dd'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" rel="noopener"><code>Date</code></a>
<ul>
<li><code>Date.prototype.getFullYear()</code></li>
<li><code>Date.prototype.getMonth()</code>
<ul>
<li><strong>0-11</strong></li>
</ul>
</li>
<li><code>Date.prototype.getDate()</code>
<ul>
<li>1-31</li>
</ul>
</li>
<li><code>Date.prototype.getDay()</code>
<ul>
<li>0(Sunday)-6</li>
</ul>
</li>
<li><code>Date.prototype.getHours()</code></li>
<li><code>Date.prototype.getMinutes()</code></li>
<li><code>Date.prototype.getSeconds()</code></li>
<li><code>Date.prototype.getMilliseconds()</code></li>
<li><code>Date.now()</code></li>
<li><code>Date.prototype.getTime()</code></li>
</ul>
</li>
</ul>
<h3>js libraries</h3>
<p>使用 app script 的網頁可以用很多 library</p>
<p>可以參考他們有 host 哪些 <a href="https://developers.google.com/speed/libraries" target="_blank" rel="noopener">https://developers.google.com/speed/libraries</a></p>
<p>所以也可以搭配 jquery library 很簡單的在網頁上做出 date picker 效果</p>
<hr>
<h2>Others</h2>
<ul>
<li>現在 line notify 已經可以支援送本地的圖檔: <a href="https://engineering.linecorp.com/zh-hant/blog/using-line-notify-to-send-stickers-and-upload-images/" target="_blank" rel="noopener">link</a></li>
</ul>
<hr>
<h2>References</h2>
<p><a href="https://www.books.com.tw/products/0010849846" target="_blank" rel="noopener">這次主要參考的工具書</a></p>
<p><a href="https://developers.google.com/apps-script/quickstart/custom-functions" target="_blank" rel="noopener">Google 提供的 quick start</a></p>
<p><a href="https://developers.google.com/apps-script/guides/html/templates#scriptlets" target="_blank" rel="noopener">Template doc</a></p>
<p><a href="https://developers.google.com/apps-script/guides/html/reference/run" target="_blank" rel="noopener">Run server code at client side</a></p>
<p><a href="https://www.udemy.com/course/course-apps-script/" target="_blank" rel="noopener">Udemy 上的教學課程(我沒有看，同事提供的)</a></p>
<p><a href="https://hawksey.info/blog/2020/10/working-with-pivot-tables-in-google-sheets-using-google-apps-script/#gref" target="_blank" rel="noopener">用錄製巨集的方式做樞紐分析</a></p>
<p><a href="https://gist.github.com/rcknr/6095720" target="_blank" rel="noopener">用 app script 接 twitter Oauth 傳圖片的範例</a></p>
<p><a href="http://white5168.blogspot.com/2018/04/google-apps-script-19-google-line-notify.html#.YaMdGvFBxhE" target="_blank" rel="noopener">使用 App script + Line notify 同時傳送圖檔跟文字</a></p>
<p><a href="https://blog.kalan.dev/2021-03-13-html-form-data/" target="_blank" rel="noopener">form 的 multipart 可以讓我們同時傳送文字圖片等多種訊息在一個 request 裡面</a></p>

                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/article/2022-02-2-retrospect_and_prospect_of_2022/" data-toggle="tooltip" data-placement="top" title="Retrospect And Prospect of 2022">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/article/2021-11-16-Rails_initialization_process/" data-toggle="tooltip" data-placement="top" title="Rails initialization process">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <br>

                <!--打赏-->
                
                <!--打赏-->

                <br>
                <!--分享-->
                
                <!--分享-->
                <br>                       
                
                <!-- require APlayer -->
                

                <!-- duoshuo Share start -->
                
                <!-- 多说 Share end-->

                <!-- 多说评论框 start -->
                
                <!-- 多说评论框 end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->

                

            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

  
    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">Intro</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">Outline</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">How to begin</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">How to Execute</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">Debug</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">Special rules</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">7.</span> <span class="toc-nav-text">Libraries</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">8.</span> <span class="toc-nav-text">Version Control</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.</span> <span class="toc-nav-text">Google Api Cheatsheet</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.1.</span> <span class="toc-nav-text">Property</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.2.</span> <span class="toc-nav-text">Google Sheet</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.2.1.</span> <span class="toc-nav-text">Special functions</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.2.2.</span> <span class="toc-nav-text">Customized menu</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.2.3.</span> <span class="toc-nav-text">Dropdown list</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.2.4.</span> <span class="toc-nav-text">Get the range of a table</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.2.5.</span> <span class="toc-nav-text">Chart</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.2.6.</span> <span class="toc-nav-text">Macro</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.3.</span> <span class="toc-nav-text">Drive</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.4.</span> <span class="toc-nav-text">get folder / file by name</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.5.</span> <span class="toc-nav-text">Web</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.5.1.</span> <span class="toc-nav-text">client side call server side script</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">9.6.</span> <span class="toc-nav-text">Calender</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">10.</span> <span class="toc-nav-text">Javascript Cheatsheet</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">10.1.</span> <span class="toc-nav-text">js libraries</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">11.</span> <span class="toc-nav-text">Others</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#null"><span class="toc-nav-number">12.</span> <span class="toc-nav-text">References</span></a></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#Javascript" title="Javascript">Javascript</a>
                        
                          <a class="tag" href="/tags/#Apps Script" title="Apps Script">Apps Script</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="https://riverye.com" target="_blank">小菜</a></li>
                    
                        <li><a href="https://chaichai.site" target="_blank">柴柴</a></li>
                    
                        <li><a href="https://louiswuyj.site" target="_blank">Louis</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>








<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℬ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>


<!-- chrome Firefox 中文锚点定位失效-->
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
<!-- smooth scroll behavior polyfill  -->
<script type="text/javascript" src="/js/smoothscroll.js"></script>
<script>
        $('#toc').on('click','a',function(a){
            // var isChrome = window.navigator.userAgent.indexOf("Chrome") !== -1;
            // console.log(window.navigator.userAgent,isChrome)
                // if(isChrome) {
                    // console.log(a.currentTarget.outerHTML);
                    // console.log($(a.currentTarget).attr("href"));
                    //跳转到指定锚点
                    // document.getElementById(a.target.innerText.toLowerCase()).scrollIntoView(true);
                    document.getElementById($(a.currentTarget).attr("href").replace("#","")).scrollIntoView({behavior: 'smooth' });
                // }
        })  
</script>


    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                    <li>
                        <a href="/atom.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                
                
                

                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/qoosuperman">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Anthony Chao 2026 
                    <br>
                    
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://qoosuperman.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-153986590-1';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = 'xxx';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="https://qoosuperman.github.io/img/icon_wechat.png" alt="prevent_hack" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
